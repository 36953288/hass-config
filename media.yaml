
  - type: picture-elements
    image: /local/overlay.svg
    anchors:
      ⚓₁: &media-text-style
        max-width: 1px
        font-family: SF Text
        font-size: 1.32vw
        font-weight: 400
        text-rendering: optimizeLegibility
        cursor: default
        color: '#fff'
        text-shadow: 1px 1px 5px rgba(18,22,23,0.9)
      ⚓₂: &media-common
        tap_action:
          action: none
        hold_action:
          action: none
        title: null
        type: image
      ⚓₃: &media-player-config
        artwork: full-cover-fit
        hide:
          controls: true
          power: true
          volume: true
          icon: true
          name: true
          info: true
          progress: true
          source: true
        tap_action: none
      ⚓₄: &media-player-style
        --ha-card-background: none
        --ha-card-box-shadow: none
        --ha-card-border-radius: 0.64vw

    elements:

      #################################################
      #                                               #
      #           RECENTLY DOWNLOADED PLEX            #
      #                                               #
      #################################################

      - conditions:
          - entity: input_select.conditional_media
            state: Senast nedladdat
        elements:
          - entity: sensor.plex_recently_added
            accent_color: none
            all_shadows: false
            border_color: none
            image_style: fanart
            flag: false
            line1_text: $empty
            line2_text: $empty
            line3_text: $empty
            line4_text: $empty
            max: 1
            title_text: $empty
            style:
              top: -3%
              left: -36%
              width: 360%
              height: 1px
            type: custom:upcoming-media-card

          - image: /local/media_plex.svg
            style: &large-icon-pos
              top: 12.85%
              left: 13.3%
              width: 15%
            <<: *media-common

          - image: /local/overlay.svg
            style: &large-overlay
              top: 133%
              left: 50%
              width: 110%
              backdrop-filter: blur(5px)
            <<: *media-common

          - prefix: Senast Nedladdat
            entity: sensor.placeholder
            style: &large-title
              top: 85%
              left: 2.1%
              color: '#e1e1e1'
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.plex_title_truncate
            style: &large-state
              top: 92.4%
              left: 2.1%
              color: '#e1e1e1'
              <<: *media-text-style
            <<: *media-common
            type: state-label
        type: conditional

      - conditions:
          - entity: input_select.conditional_media
            state_not: Senast nedladdat
        elements:
          - image: /local/overlay.svg
            style:
              top: 50%
              left: 50%
              width: 100%
              background: rgba(116,116,116,0.2)
            <<: *media-common
        type: conditional

      #################################################
      #                                               #
      #              APPLE TV VARDAGSRUM              #
      #                                               #
      #################################################

      - conditions:
          - entity: input_select.conditional_media
            state: Vardagsrum
        elements:

          - type: custom:mod-card
            style:
              top: 50%
              left: 50%
              width: 100%
              <<: *media-player-style
            card:
              entity: media_player.vardagsrum
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 60%), 
                  url("{{ states.media_player.vardagsrum.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_appletv.svg
            style: *large-icon-pos
            <<: *media-common

          - image: /local/overlay.svg
            style: *large-overlay
            <<: *media-common

          - prefix: Apple Tv - Vardagsrum
            entity: sensor.placeholder
            style:
              <<: *large-title
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_vardagsrum_title_truncate
            style:
              <<: *large-state
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - conditions:
              - entity: sensor.apple_tv_vardagsrum_status
                state_not: Av
            elements:
              - entity: switch.media_play_pause_vardagsrum
                state_image:
                  'on': /local/pause.svg
                  'off': /local/play.svg
                style:
                  top: 50%
                  left: 50%
                  width: 20%
                  filter: 'drop-shadow(0px 0px 10px #11151790)'
                <<: *media-common
                tap_action:
                  action: toggle
            type: conditional
        type: conditional

      #################################################
      #                                               #
      #                APPLE TV SOVRUM                #
      #                                               #
      #################################################

      - conditions:
          - entity: input_select.conditional_media
            state: Sovrum
        elements:

          - type: custom:mod-card
            style:
              top: 50%
              left: 50%
              width: 100%
              <<: *media-player-style
            card:
              entity: media_player.sovrum
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 60%), 
                  url("{{ states.media_player.sovrum.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_appletv.svg
            style: *large-icon-pos
            <<: *media-common

          - image: /local/overlay.svg
            style: *large-overlay
            <<: *media-common

          - prefix: Apple Tv - Sovrum
            entity: sensor.placeholder
            style:
              <<: *large-title
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_sovrum_title_truncate
            style:
              <<: *large-state
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - conditions:
              - entity: sensor.apple_tv_sovrum_status
                state_not: Av
            elements:
              - entity: switch.media_play_pause_sovrum
                state_image:
                  'on': /local/pause.svg
                  'off': /local/play.svg
                style:
                  top: 50%
                  left: 50%
                  width: 20%
                  filter: 'drop-shadow(0px 0px 10px #11151790)'
                <<: *media-common
                tap_action:
                  action: toggle
            type: conditional
        type: conditional

      #################################################
      #                                               #
      #                 PLAYSTATION 4                 #
      #                                               #
      #################################################

      - conditions:
          - entity: input_select.conditional_media
            state: Playstation 4
        elements:

          - type: custom:mod-card
            style:
              top: 50%
              left: 50%
              width: 100%
              <<: *media-player-style
            card:
              entity: media_player.playstation_4
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 60%), 
                  url("{{ states.media_player.playstation_4.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_playstation.svg
            style: *large-icon-pos
            <<: *media-common

          - image: /local/overlay.svg
            style: *large-overlay
            <<: *media-common

          - prefix: Playstation 4
            entity: sensor.placeholder
            style:
              <<: *large-title
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.playstation_title_truncate
            style:
              <<: *large-state
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - conditions:
              - entity: media_player.playstation_4
                state_not: standby
            elements:
              - entity: switch.media_play_pause_playstation_4
                state_image:
                  'on': /local/pause.svg
                  'off': /local/play.svg
                style:
                  top: 50%
                  left: 50%
                  width: 20%
                  filter: 'drop-shadow(0px 0px 10px #11151790)'
                <<: *media-common
                tap_action:
                  action: toggle
            type: conditional
        type: conditional

      #################################################
      #                                               #
      #               GOOGLE NEST MINI                #
      #                                               #
      #################################################

      - conditions:
          - entity: input_select.conditional_media
            state: Google Nest Mini
        elements:

          - type: custom:mod-card
            style:
              top: 50%
              left: 50%
              width: 100%
              <<: *media-player-style
            card:
              entity: media_player.google_nest_mini
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.5) 0%, rgba(0,0,0,0) 60%), 
                  url("{{ states.media_player.google_nest_mini.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_googlenest.svg
            style: *large-icon-pos
            <<: *media-common

          - image: /local/overlay.svg
            style: *large-overlay
            <<: *media-common

          - prefix: Google Nest Mini
            entity: sensor.placeholder
            style:
              <<: *large-title
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.google_nest_mini_title_truncate
            style:
              <<: *large-state
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - conditions:
              - entity: media_player.google_nest_mini
                state_not: 'off'
            elements:
              - entity: switch.media_play_pause_google_nest_mini
                state_image:
                  'on': /local/pause.svg
                  'off': /local/play.svg
                style:
                  top: 50%
                  left: 50%
                  width: 20%
                  filter: 'drop-shadow(0px 0px 10px #11151790)'
                <<: *media-common
                tap_action:
                  action: toggle
            type: conditional
        type: conditional

      #################################################
      #                                               #
      #           * SMALL MEDIA CONTROLS *            #
      #                                               #
      #################################################

  - type: picture-elements
    image: /local/overlay.svg
    elements:

      #################################################
      #                                               #
      #           SMALL APPLE TV VARDAGSRUM           #
      #                                               #
      #################################################

      # on
      - conditions:
          - entity: sensor.apple_tv_vardagsrum_status
            state_not: Av
        elements:

          - image: /local/btn/med_small.svg
            style: &small-vardagsrum-pos
              top: 23.8%
              left: 23.8%
              width: 47.86%
            <<: *media-common

          - type: custom:mod-card
            style:
              <<: *small-vardagsrum-pos
              <<: *media-player-style
            card:
              entity: media_player.vardagsrum
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%), 
                  url("{{ states.media_player.vardagsrum.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_appletv.svg
            style: &icon-vardagsrum-pos
              top: 11%
              left: 11%
              width: 12.5%
              opacity: 0.9
            <<: *media-common

          - prefix: Vardagsrum
            entity: sensor.placeholder
            style: &small-title-vardagsrum-pos
              top: 32.2%
              left: 2.1%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_vardagsrum_status
            style: &small-state-vardagsrum-pos
              top: 39.9%
              left: 2.1%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - image: /local/overlay.svg
            style: *small-vardagsrum-pos
            tap_action:
              action: call-service
              service: media_player.media_play_pause
              service_data:
                entity_id: media_player.vardagsrum
            hold_action:
              action: none
            title: null
            type: image

        type: conditional

      # off
      - conditions:
          - entity: sensor.apple_tv_vardagsrum_status
            state: Av
        elements:

          - image: /local/btn/med_small.svg
            style: *small-vardagsrum-pos
            <<: *media-common

          - image: /local/media_appletv.svg
            style:
              <<: *icon-vardagsrum-pos
              opacity: .07
            <<: *media-common

          - prefix: Vardagsrum
            entity: sensor.placeholder
            style:
              <<: *small-title-vardagsrum-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_vardagsrum_status
            style:
              <<: *small-state-vardagsrum-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

        type: conditional

      #################################################
      #                                               #
      #             SMALL APPLE TV SOVRUM             #
      #                                               #
      #################################################

      # on
      - conditions:
          - entity: sensor.apple_tv_sovrum_status
            state_not: Av
        elements:

          - image: /local/btn/med_small.svg
            style: &small-sovrum-pos
              top: 23.8%
              left: 76.2%
              width: 47.86%
            <<: *media-common

          - type: custom:mod-card
            style:
              <<: *small-sovrum-pos
              <<: *media-player-style
            card:
              entity: media_player.sovrum
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%), 
                  url("{{ states.media_player.sovrum.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_appletv.svg
            style: &icon-sovrum-pos
              top: 11%
              left: 63%
              width: 12.5%
              opacity: 0.9
            <<: *media-common

          - prefix: Sovrum
            entity: sensor.placeholder
            style: &small-title-sovrum-pos
              top: 32.2%
              left: 54.6%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_sovrum_status
            style: &small-state-sovrum-pos
              top: 39.9%
              left: 54.6%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - image: /local/overlay.svg
            style: *small-sovrum-pos
            tap_action:
              action: call-service
              service: media_player.media_play_pause
              service_data:
                entity_id: media_player.sovrum
            hold_action:
              action: none
            title: null
            type: image

        type: conditional

      # off
      - conditions:
          - entity: sensor.apple_tv_sovrum_status
            state: Av
        elements:

          - image: /local/btn/med_small.svg
            style: *small-sovrum-pos
            <<: *media-common

          - image: /local/media_appletv.svg
            style:
              <<: *icon-sovrum-pos
              opacity: .07
            <<: *media-common

          - prefix: Sovrum
            entity: sensor.placeholder
            style:
              <<: *small-title-sovrum-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.apple_tv_vardagsrum_status
            style:
              <<: *small-state-sovrum-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

        type: conditional

      #################################################
      #                                               #
      #              SMALL PLAYSTATION 4              #
      #                                               #
      #################################################

      # on
      - conditions:
          - entity: sensor.playstation_status
            state_not: Av
        elements:

          - image: /local/btn/med_small.svg
            style: &small-playstation-pos
              top: 76.2%
              left: 23.8%
              width: 47.86%
            <<: *media-common

          - type: custom:mod-card
            style:
              <<: *small-playstation-pos
              <<: *media-player-style
            card:
              entity: media_player.playstation_4
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%), 
                  url("{{ states.media_player.playstation_4.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_playstation.svg
            style: &icon-playstation-pos
              top: 64%
              left: 11%
              width: 12.5%
              opacity: 0.9
            <<: *media-common

          - prefix: Playstation
            entity: sensor.placeholder
            style: &small-title-playstation-pos
              top: 85%
              left: 2.1%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.playstation_status
            style: &small-state-playstation-pos
              top: 92.4%
              left: 2.1%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - image: /local/overlay.svg
            style: *small-playstation-pos
            tap_action:
              action: call-service
              service: script.turn_on
              service_data:
                entity_id: script.media_ps4_ps_button
            hold_action:
              action: none
            title: null
            type: image

        type: conditional

      # off
      - conditions:
          - entity: sensor.playstation_status
            state: Av
        elements:

          - image: /local/btn/med_small.svg
            style: *small-playstation-pos
            <<: *media-common

          - image: /local/media_playstation.svg
            style:
              <<: *icon-playstation-pos
              opacity: .07
            <<: *media-common

          - prefix: Playstation
            entity: sensor.placeholder
            style:
              <<: *small-title-playstation-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.playstation_status
            style:
              <<: *small-state-playstation-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

        type: conditional

      #################################################
      #                                               #
      #            SMALL GOOGLE NEST MINI             #
      #                                               #
      #################################################

      # on
      - conditions:
          - entity: sensor.google_nest_mini_status
            state_not: Av
        elements:

          - image: /local/btn/med_small.svg
            style: &small-nest-pos
              top: 76.2%
              left: 76.2%
              width: 47.86%
            <<: *media-common

          - type: custom:mod-card
            style:
              <<: *small-nest-pos
              <<: *media-player-style
            card:
              entity: media_player.google_nest_mini
              <<: *media-player-config
              style: |
                ha-card > div.mmp__bg > div {
                  background-image: linear-gradient(0deg, rgba(0,0,0,0.8) 0%, rgba(0,0,0,0) 100%), 
                  url("{{ states.media_player.google_nest_mini.attributes.entity_picture }}") !important;
                  background-size: cover !important;
                }
              type: custom:mini-media-player

          - image: /local/media_googlenest.svg
            style: &icon-nest-pos
              top: 64%
              left: 63%
              width: 12.5%
              opacity: 0.9
            <<: *media-common

          - prefix: Nest Mini
            entity: sensor.placeholder
            style: &small-title-nest-pos
              top: 85%
              left: 54.6%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.google_nest_mini_status
            style: &small-state-nest-pos
              top: 92.4%
              left: 54.6%
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - image: /local/overlay.svg
            style: *small-nest-pos
            tap_action:
              action: call-service
              service: media_player.media_play_pause
              service_data:
                entity_id: media_player.google_nest_mini
            hold_action:
              action: none
            title: null
            type: image

        type: conditional

      # off
      - conditions:
          - entity: sensor.google_nest_mini_status
            state: Av
        elements:

          - image: /local/btn/med_small.svg
            style: *small-nest-pos
            <<: *media-common

          - image: /local/media_appletv.svg
            style:
              <<: *icon-nest-pos
              opacity: .07
            <<: *media-common

          - prefix: Nest Mini
            entity: sensor.placeholder
            style:
              <<: *small-title-nest-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

          - entity: sensor.google_nest_mini_status
            style:
              <<: *small-state-nest-pos
              color: '#717777'
              text-shadow: none
              <<: *media-text-style
            <<: *media-common
            type: state-label

        type: conditional
